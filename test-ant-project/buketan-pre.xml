<?xml version="1.0" encoding="UTF-8"?>
<project name="buketan-pre" xmlns:ivy="antlib:org.apache.ivy.ant">
    <property name="resource.svg.absolute.dir" location="res-svg"/>

	<target name="fetch-buketan">
		<property name="buketan.version" value="0.1-SNAPSHOT"/>
        <ivy:settings id="buketan.ivy.settings" file="buketan-ivysettings.xml"/>
		<ivy:resolve settingsRef="buketan.ivy.settings" inline="true"
			organisation="net.kriomant.buketan" module="ant-plugin_2.9.2"
			conf="default" revision="${buketan.version}" resolveId="buketan"
		/>
		<ivy:cachepath pathid="buketan-task.path" settingsRef="buketan.ivy.settings" inline="true"
			organisation="net.kriomant.buketan" module="ant-plugin_2.9.2"
			conf="default" revision="${buketan.version}"
			resolveId="buketan"
		/>
		<taskdef resource="buketan_ant.properties" classpathref="buketan-task.path"/>
	</target>

	<target name="-clean-temporary-resource-directory">
		<delete dir="${out.res.tmp.absolute.dir}"/>
		<mkdir dir="${out.res.tmp.absolute.dir}"/>
	</target>

	<target name="render-svg-resources" depends="fetch-buketan">
		<buketan targetdirectory="${out.res.tmp.absolute.dir}">
			<fileset dir="${resource.svg.absolute.dir}">
				<include name="*.svg"/>
			</fileset>
		</buketan>
	</target>

	<target name="-copy-original-resources">
		<copy todir="${out.res.tmp.absolute.dir}">
			<fileset dir="${resource.absolute.dir}"/>
		</copy>
	</target>

	<target name="buketan" depends="fetch-buketan, -clean-temporary-resource-directory, render-svg-resources, -copy-original-resources">
	</target>

    <target name="-crunch" depends="buketan">
        <exec executable="${aapt}" taskName="crunch">
            <arg value="crunch" />
            <arg value="-v" />
            <arg value="-S" />
            <arg path="${out.res.tmp.absolute.dir}" />
            <arg value="-C" />
            <arg path="${out.res.absolute.dir}" />
        </exec>
    </target>
</project>

